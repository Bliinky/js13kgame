<p><canvas id="canvas" width="200" height="200"></p>

<script type="text/javascript" src="./physics.js"></script>
<script type="text/javascript" src="./physicsSpec.js"></script>

<script type="text/javascript">
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

var pressedKeys = [];

var isKeyPressed = function isKeyPressed(keyCode){
  return pressedKeys.indexOf(keyCode) != -1;
}

document.body.onkeydown = function(e){
  if(pressedKeys.indexOf(e.keyCode) == -1){
    pressedKeys.push(e.keyCode);
  }
}

document.body.onkeyup = function(e){
  var index = pressedKeys.indexOf(e.keyCode);
  if(index != -1){
    pressedKeys.splice(index, 1);
  }
}

var onGround = false;
var player = new Entity(100, 10, 10, 10, true);
var ground = new Entity(0, 185, 50, 10, false);



loop();

function loop()
{
    update();
    render(player);
    render(ground);
    window.setTimeout(loop, 33);
}

function update()
{

    if(isKeyPressed(37)){
      Physics.moveLeft(player);
    }else if(isKeyPressed(39)){
      Physics.moveRight(player);
    }

    if(isKeyPressed(38) && onGround){
      Physics.jump(player);
    }

    Physics.update(player);

    if(Physics.checkCollision(player, ground)){
      player.velY = 0;
      // Why do I have to do this ?
      player.y = ground.y - 10;
    }

    onGround = (player.y === (ground.y - 10));

}

function render(entity)
{
    ctx.clearRect(0, 0, 200, 200);
    ctx.stroke();
    ctx.beginPath();
    ctx.rect(entity.x, entity.y, entity.width, entity.height);
    ctx.closePath();
    ctx.stroke();
}


</script>
